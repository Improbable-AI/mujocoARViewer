syntax = "proto3";

package mujoco_ar;

// Service definition for MuJoCo AR communication
service MuJoCoARService {
  // Send USDZ URL to VR device
  rpc SendUsdzUrl(UsdzUrlRequest) returns (UsdzUrlResponse);
  
  // Send USDZ file data directly
  rpc SendUsdzData(UsdzDataRequest) returns (UsdzDataResponse);
  
  // Send USDZ file data in chunks (for large files)
  rpc SendUsdzDataChunked(stream UsdzChunkRequest) returns (UsdzDataResponse);
  
  // Stream body pose updates to VR device
  rpc StreamPoses(stream PoseUpdateRequest) returns (stream PoseUpdateResponse);
  
  // Single pose update (alternative to streaming)
  rpc UpdatePoses(PoseUpdateRequest) returns (PoseUpdateResponse);
}

// Request to send USDZ URL
message UsdzUrlRequest {
  string usdz_url = 1;
  string session_id = 2;
}

// Response for USDZ URL
message UsdzUrlResponse {
  bool success = 1;
  string message = 2;
}

// Request to send USDZ file data
message UsdzDataRequest {
  bytes usdz_data = 1;
  string filename = 2;
  string session_id = 3;
}

// Request for chunked USDZ file transfer
message UsdzChunkRequest {
  bytes chunk_data = 1;
  string filename = 2;
  string session_id = 3;
  int32 chunk_index = 4;
  int32 total_chunks = 5;
  int64 total_size = 6;
  bool is_last_chunk = 7;
}

// Response for USDZ data
message UsdzDataResponse {
  bool success = 1;
  string message = 2;
  string local_file_path = 3;
}

// 3D Vector for position
message Vector3 {
  float x = 1;
  float y = 2;
  float z = 3;
}

// Quaternion for rotation
message Quaternion {
  float x = 1;
  float y = 2;
  float z = 3;
  float w = 4;
}

// Body pose containing position and rotation
message BodyPose {
  Vector3 position = 1;
  Quaternion rotation = 2;
  string body_name = 3;
}

// Request containing multiple body poses
message PoseUpdateRequest {
  repeated BodyPose body_poses = 1;
  string session_id = 2;
  double timestamp = 3;
}

// Response for pose updates
message PoseUpdateResponse {
  bool success = 1;
  string message = 2;
  int32 bodies_updated = 3;
}